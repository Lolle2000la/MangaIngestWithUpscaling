@using MangaIngestWithUpscaling.Data.LibraryManagement
@using MangaIngestWithUpscaling.Shared.Data.LibraryManagement
@using MangaIngestWithUpscaling.Helpers
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<EditLibraryFilters> Loc
<MudStack>
    <MudText Typo="Typo.h5">
        @Loc["Title"]
    </MudText>
    <MudText Typo="Typo.body1">
        @Loc["Description"]
    </MudText>

    <MudTable T="LibraryFilterRule" Items="@Library.FilterRules" Dense>
        <HeaderContent>
            <MudTh>@Loc["Header_PatternToMatch"]</MudTh>
            <MudTh>@Loc["Header_PatternType"]</MudTh>
            <MudTh>@Loc["Header_TargetField"]</MudTh>
            <MudTh>@Loc["Header_Action"]</MudTh>
            <MudTh>
                <MudIconButton Icon="@Icons.Material.Filled.Add"
                    OnClick="() => Library.FilterRules.Add(new LibraryFilterRule { Library = Library})" />
            </MudTh>
        </HeaderContent>
        <RowTemplate>
            <MudTd DataLabel="@Loc["Header_PatternToMatch"]">@context.Pattern</MudTd>
            <MudTd DataLabel="@Loc["Header_PatternType"]">@context.PatternType.GetDisplayName()</MudTd>
            <MudTd DataLabel="@Loc["Header_TargetField"]">@context.TargetField.GetDisplayName()</MudTd>
            <MudTd DataLabel="@Loc["Header_Action"]">@context.Action.GetDisplayName()</MudTd>
            <MudTd>
                <MudIconButton Icon="@Icons.Material.Filled.Delete" Color="Color.Error"
                    OnClick="() => Library.FilterRules.Remove(context)" />
            </MudTd>
        </RowTemplate>
        <RowEditingTemplate>
            <EditLibraryFilterForm FilterRule="@context" />
        </RowEditingTemplate>
    </MudTable>
</MudStack>

@code {
    [Parameter] public required Library Library { get; set; }
}
@page "/"
@using MangaIngestWithUpscaling.Services.BackgroundTaskQueue
@using MangaIngestWithUpscaling.Services.BackgroundTaskQueue.Tasks

@inject ITaskQueue TaskQueue
@inject IWebHostEnvironment WebHostEnvironment

<PageTitle>Home</PageTitle>

<MudGrid>
    <MudItem xs="12">
        <MudText Typo="Typo.h3" GutterBottom="true" Class="mb-6">
            Welcome to Manga Ingest
        </MudText>
    </MudItem>

    <!-- Quick Start Guide -->
    <MudItem xs="12" md="8">
        <MudPaper Elevation="2" Class="pa-6">
            <MudText Typo="Typo.h4" GutterBottom="true" Color="Color.Primary">
                <MudIcon Icon="@Icons.Material.Filled.Rocket" Class="mr-3" />
                Quick Start Guide
            </MudText>
            <MudText Typo="Typo.body1" Class="mb-4">
                Get started with manga ingestion and upscaling in just a few steps:
            </MudText>
            
            <MudTimeline TimelinePosition="TimelinePosition.Left">
                <MudTimelineItem Color="Color.Primary" Icon="@Icons.Material.Filled.CreateNewFolder">
                    <MudText Typo="Typo.h6" Class="mb-2">Set up a Library</MudText>
                    <MudText Typo="Typo.body2" Class="mb-2">
                        Create a new library in the 
                        <MudLink Href="libraries" Color="Color.Primary" Underline="Underline.Hover">Libraries</MudLink> 
                        section to define where your manga files will be stored.
                    </MudText>
                </MudTimelineItem>
                
                <MudTimelineItem Color="Color.Secondary" Icon="@Icons.Material.Filled.Upload">
                    <MudText Typo="Typo.h6" Class="mb-2">Add Manga Files</MudText>
                    <MudText Typo="Typo.body2" Class="mb-2">
                        Add manga files to your configured ingest folder. The system will automatically detect and process them.
                    </MudText>
                </MudTimelineItem>
                
                <MudTimelineItem Color="Color.Success" Icon="@Icons.Material.Filled.AutoAwesome">
                    <MudText Typo="Typo.h6" Class="mb-2">Automatic Processing</MudText>
                    <MudText Typo="Typo.body2" Class="mb-2">
                        Wait for the system to ingest the mangas and chapters. This happens automatically in the background.
                    </MudText>
                </MudTimelineItem>
                
                <MudTimelineItem Color="Color.Tertiary" Icon="@Icons.Material.Filled.ImageAspectRatio">
                    <MudText Typo="Typo.h6" Class="mb-2">Upscale Content</MudText>
                    <MudText Typo="Typo.body2">
                        Configure upscaling profiles and let the system enhance your manga images automatically or on-demand.
                    </MudText>
                </MudTimelineItem>
            </MudTimeline>
        </MudPaper>
    </MudItem>

    <!-- Quick Actions -->
    <MudItem xs="12" md="4">
        <MudPaper Elevation="2" Class="pa-6">
            <MudText Typo="Typo.h5" GutterBottom="true" Color="Color.Primary">
                <MudIcon Icon="@Icons.Material.Filled.FlashOn" Class="mr-3" />
                Quick Actions
            </MudText>
            
            <MudStack Spacing="3">
                <MudButton Href="libraries/create" 
                           Variant="Variant.Filled" 
                           Color="Color.Primary" 
                           StartIcon="@Icons.Material.Filled.Add"
                           FullWidth="true"
                           Size="Size.Large">
                    Create Library
                </MudButton>
                
                <MudButton Href="upscaling/profiles" 
                           Variant="Variant.Outlined" 
                           Color="Color.Secondary" 
                           StartIcon="@Icons.Material.Filled.ImageAspectRatio"
                           FullWidth="true"
                           Size="Size.Large">
                    Manage Profiles
                </MudButton>
                
                <MudButton Href="tasks" 
                           Variant="Variant.Text" 
                           Color="Color.Tertiary" 
                           StartIcon="@Icons.Material.Filled.Task"
                           FullWidth="true"
                           Size="Size.Large">
                    View Tasks
                </MudButton>
                
                <MudButton Href="logs" 
                           Variant="Variant.Text" 
                           Color="Color.Default" 
                           StartIcon="@Icons.Material.Filled.List"
                           FullWidth="true"
                           Size="Size.Large">
                    System Logs
                </MudButton>
            </MudStack>
        </MudPaper>
    </MudItem>

    <!-- Development Section -->
    @if (WebHostEnvironment.IsDevelopment())
    {
        <MudItem xs="12">
            <MudPaper Elevation="1" Class="pa-4" Style="border-left: 4px solid var(--mud-palette-warning);">
                <MudAlert Severity="Severity.Info" Variant="Variant.Text" Class="mb-4">
                    <MudText Typo="Typo.body2">
                        <strong>Development Mode:</strong> Additional debugging tools are available.
                    </MudText>
                </MudAlert>
                
                <MudText Typo="Typo.h6" Class="mb-3">Task Queue Test</MudText>
                <MudGrid>
                    <MudItem xs="12" sm="8">
                        <MudTextField @bind-Value="message" 
                                      Label="Test Message" 
                                      Variant="Variant.Outlined" 
                                      FullWidth="true" />
                    </MudItem>
                    <MudItem xs="12" sm="4">
                        <MudButton OnClick="TestTaskQueue" 
                                   Variant="Variant.Filled" 
                                   Color="Color.Info"
                                   StartIcon="@Icons.Material.Filled.PlayArrow"
                                   FullWidth="true">
                            Enqueue Test Task
                        </MudButton>
                    </MudItem>
                </MudGrid>
            </MudPaper>
        </MudItem>
    }

    <!-- Dependencies & Licenses -->
    <MudItem xs="12">
        <MudExpansionPanels Elevation="2">
            <MudExpansionPanel Text="Dependencies & Licenses" Icon="@Icons.Material.Filled.Info">
                <TitleContent>
                    <div class="d-flex align-center">
                        <MudIcon Icon="@Icons.Material.Filled.Info" Class="mr-3" />
                        <MudText Typo="Typo.h6">Dependencies & Licenses</MudText>
                    </div>
                </TitleContent>
                <ChildContent>
                    <MudGrid>
                        <MudItem xs="12" md="6">
                            <MudText Typo="Typo.subtitle1" Class="mb-3" Color="Color.Primary">Core Dependencies</MudText>
                            <MudList T="string" Dense="true">
                                <MudListItem T="string" Icon="@Icons.Material.Filled.AutoAwesome">
                                    <div>
                                        <MudLink Href="https://github.com/the-database/MangaJaNai/blob/main/LICENSE" Target="_blank" Color="Color.Primary">
                                            MangaJaNai
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">Attribution-NonCommercial 4.0 International</MudText>
                                        <MudText Typo="Typo.caption">High-quality manga upscaling model</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Terminal">
                                    <div>
                                        <MudLink Href="https://github.com/the-database/MangaJaNaiConverterGui/blob/main/LICENSE" Target="_blank" Color="Color.Primary">
                                            MangaJaNaiConverterGui
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">GNU General Public License v3.0</MudText>
                                        <MudText Typo="Typo.caption">Upscaling CLI integration</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Web">
                                    <div>
                                        <MudLink Href="https://github.com/dotnet/aspnetcore/blob/main/LICENSE.txt" Target="_blank" Color="Color.Primary">
                                            .NET & ASP.NET Core
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">MIT License</MudText>
                                        <MudText Typo="Typo.caption">Web framework and runtime</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Palette">
                                    <div>
                                        <MudLink Href="https://github.com/MudBlazor/MudBlazor/blob/dev/LICENSE" Target="_blank" Color="Color.Primary">
                                            MudBlazor
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">MIT License</MudText>
                                        <MudText Typo="Typo.caption">Material Design component library</MudText>
                                    </div>
                                </MudListItem>
                            </MudList>
                        </MudItem>
                        
                        <MudItem xs="12" md="6">
                            <MudText Typo="Typo.subtitle1" Class="mb-3" Color="Color.Primary">Supporting Libraries</MudText>
                            <MudList T="string" Dense="true">
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Image">
                                    <div>
                                        <MudLink Href="https://github.com/kleisauke/net-vips/blob/master/LICENSE" Target="_blank" Color="Color.Primary">
                                            NetVips
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">MIT License</MudText>
                                        <MudText Typo="Typo.caption">High-performance image processing</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Storage">
                                    <div>
                                        <MudLink Href="https://github.com/serilog/serilog/blob/dev/LICENSE" Target="_blank" Color="Color.Primary">
                                            Serilog
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">Apache-2.0 License</MudText>
                                        <MudText Typo="Typo.caption">Structured logging</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Api">
                                    <div>
                                        <MudLink Href="https://github.com/grpc/grpc-dotnet/blob/master/LICENSE" Target="_blank" Color="Color.Primary">
                                            gRPC
                                        </MudLink>
                                        <MudText Typo="Typo.body2" Color="Color.Secondary">Apache-2.0 License</MudText>
                                        <MudText Typo="Typo.caption">Remote procedure calls</MudText>
                                    </div>
                                </MudListItem>
                                
                                <MudListItem T="string" Icon="@Icons.Material.Filled.Extension">
                                    <div>
                                        <MudText Typo="Typo.body2" Color="Color.Primary">+ Many more supporting libraries</MudText>
                                        <MudText Typo="Typo.caption">All following their respective open source licenses</MudText>
                                    </div>
                                </MudListItem>
                            </MudList>
                        </MudItem>
                    </MudGrid>
                </ChildContent>
            </MudExpansionPanel>
        </MudExpansionPanels>
    </MudItem>
</MudGrid>

@code {
    private string message = "Hello, world!";

    private async Task TestTaskQueue()
    {
        await TaskQueue.EnqueueAsync(new LoggingTask { Message = message });
    }
}